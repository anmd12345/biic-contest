@using BIIC_Contest.Constants
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="en-US" dir="ltr" data-navigation-type="default" data-navbar-horizontal-shape="default">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <title>BIIC Authentication - Login</title>

    @Html.Action("FaviconPartial", "Partial")

    <meta name="theme-color" content="#ffffff">
    <script src="~/vendors/simplebar/simplebar.min.js"></script>
    <script src="~/assets/js/config.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&amp;display=swap" rel="stylesheet">
    <link href="~/vendors/simplebar/simplebar.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.8/css/line.css">
    <link href="~/assets/css/theme-rtl.min.css" type="text/css" rel="stylesheet" id="style-rtl">
    <link href="~/assets/css/theme.min.css" type="text/css" rel="stylesheet" id="style-default">
    <link href="~/assets/css/user-rtl.min.css" type="text/css" rel="stylesheet" id="user-style-rtl">
    <link href="~/assets/css/user.min.css" type="text/css" rel="stylesheet" id="user-style-default">
    <script>
        var phoenixIsRTL = window.config.config.phoenixIsRTL;
        if (phoenixIsRTL) {
            var linkDefault = document.getElementById('style-default');
            var userLinkDefault = document.getElementById('user-style-default');
            linkDefault.setAttribute('disabled', true);
            userLinkDefault.setAttribute('disabled', true);
            document.querySelector('html').setAttribute('dir', 'rtl');
        } else {
            var linkRTL = document.getElementById('style-rtl');
            var userLinkRTL = document.getElementById('user-style-rtl');
            linkRTL.setAttribute('disabled', true);
            userLinkRTL.setAttribute('disabled', true);
        }
    </script>
</head>

<body>
    <main class="main" id="top">
        <div class="container-fluid bg-body-tertiary dark__bg-gray-1200">
            <div class="bg-holder bg-auth-card-overlay" style="background-image:url(/assets/img/bg/37.png);"></div>
            <div class="row flex-center position-relative min-vh-100 g-0 py-5">
                <div class="col-11 col-sm-10 col-xl-8">
                    <div class="card border border-translucent auth-card">
                        <div class="card-body pe-md-0">
                            <div class="row align-items-center gx-0 gy-7">
                                <div class="col-auto bg-body-highlight dark__bg-gray-1100 rounded-3 position-relative overflow-hidden auth-title-box">
                                    <div class="bg-holder" style="background-image:url(/assets/img/bg/38.png);"></div>
                                    <div class="position-relative px-4 px-lg-7 pt-7 pb-7 pb-sm-5 text-center text-md-start pb-lg-7 pb-md-7">
                                        <h3 class="mb-3 text-body-emphasis fs-7">BIIC Authentication</h3>
                                        <p class="text-body-tertiary">Give yourself some hassle-free development process with the uniqueness of BIIC!</p>
                                        <ul class="list-unstyled mb-0 w-max-content w-md-auto">
                                            <li class="d-flex align-items-center"><span class="uil uil-check-circle text-success me-2"></span><span class="text-body-tertiary fw-semibold">Fast</span></li>
                                            <li class="d-flex align-items-center"><span class="uil uil-check-circle text-success me-2"></span><span class="text-body-tertiary fw-semibold">Simple</span></li>
                                            <li class="d-flex align-items-center"><span class="uil uil-check-circle text-success me-2"></span><span class="text-body-tertiary fw-semibold">Convenient</span></li>
                                        </ul>
                                    </div>
                                    <div class="position-relative z-n1 mb-6 d-none d-md-block text-center mt-md-15">
                                        <img style="border-top-left-radius: 20%; border-bottom-right-radius: 20%" class="auth-title-box-img d-dark-none" src="@ResourceConstant.DEFAULT_BANNER_URL" alt="" />
                                        <img style="border-top-left-radius: 20%; border-bottom-right-radius: 20%" class="auth-title-box-img d-light-none" src="@ResourceConstant.DEFAULT_BANNER_URL" alt="" />
                                    </div>
                                </div>
                                <div class="col mx-auto">
                                    <div class="auth-form-box">
                                        <div class="text-center mb-7">
                                            <a class="d-flex flex-center text-decoration-none mb-4" href="@RouteConstant.HOME_PAGE">
                                                <div class="d-flex align-items-center fw-bolder fs-3 d-inline-block"><img src="@ResourceConstant.DEFAULT_LOGO_URL" alt="BIIC Logo" width="58" /></div>
                                            </a>
                                            <h3 class="text-body-highlight">Đăng Nhập</h3>
                                            <p class="text-body-tertiary">Truy cập tài khoản của bạn tại đây</p>
                                        </div>
                                        <button class="btn btn-phoenix-secondary w-100 mb-3">
                                            <span class="fab fa-google text-danger me-2 fs-9"></span>
                                            Đăng nhập với Google
                                        </button>
                                        <button class="btn btn-phoenix-secondary w-100">
                                            <span class="fab fa-facebook text-primary me-2 fs-9"></span>
                                            Đăng nhập với Facebook
                                        </button>
                                        <div class="position-relative">
                                            <hr class="bg-body-secondary mt-5 mb-4" />
                                            <div class="divider-content-center bg-body-emphasis">hoặc</div>
                                        </div>
                                        <div class="mb-3 text-start">
                                            <label class="form-label" for="username">Tài khoản</label>
                                            <div class="form-icon-container"><input class="form-control form-icon-input" id="username" type="text" placeholder="Tài khoản đăng nhập" /><span class="fas fa-user text-body fs-9 form-icon"></span></div>
                                        </div>
                                        <div class="mb-3 text-start">
                                            <label class="form-label" for="password">Mật khẩu</label>
                                            <div class="form-icon-container" data-password="data-password">
                                                <input class="form-control form-icon-input pe-6" id="password" type="password" placeholder="Mật khẩu" data-password-input="data-password-input" /><span class="fas fa-key text-body fs-9 form-icon"></span><button class="btn px-3 py-0 h-100 position-absolute top-0 end-0 fs-7 text-body-tertiary" data-password-toggle="data-password-toggle"><span class="uil uil-eye show"></span><span class="uil uil-eye-slash hide"></span></button>
                                            </div>
                                        </div>
                                        <div class="row flex-between-center mb-7">
                                            <div class="col-auto">
                                                <div class="form-check mb-0">
                                                    <input class="form-check-input" id="basic-checkbox" type="checkbox" checked="checked" />
                                                    <label class="form-check-label mb-0" for="basic-checkbox">Lưu mật khẩu</label>
                                                </div>
                                            </div>
                                            <div class="col-auto">
                                                <a class="fs-9 fw-semibold" href="@RouteConstant.FORGOT_PASSWORD_PAGE">Quên mật khẩu?</a>
                                            </div>
                                        </div>
                                        <button class="btn btn-primary w-100 mb-3" onclick="handleLogin(this)">Đăng Nhập</button>
                                        <button class="btn btn-primary w-100 mb-3" id="btn-spinner" type="button" style="display: none">
                                            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                            Vui lòng chờ...
                                        </button>
                                        <div class="text-center">
                                            <a class="fs-9 fw-bold" href="@RouteConstant.SIGNUP_PAGE">Tạo tài khoản</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Support Chat -->
        @Html.Action("SupportChatPartial", "Partial")
    </main>

    <!-- Setting Canvas -->
    @Html.Action("SettingCanvasPartial", "Partial")

    <script src="~/vendors/popper/popper.min.js"></script>
    <script src="~/vendors/bootstrap/bootstrap.min.js"></script>
    <script src="~/vendors/anchorjs/anchor.min.js"></script>
    <script src="~/vendors/is/is.min.js"></script>
    <script src="~/vendors/fontawesome/all.min.js"></script>
    <script src="~/vendors/lodash/lodash.min.js"></script>
    <script src="~/vendors/list.js/list.min.js"></script>
    <script src="~/vendors/feather-icons/feather.min.js"></script>
    <script src="~/vendors/dayjs/dayjs.min.js"></script>
    <script src="~/assets/js/phoenix.js"></script>
    <script src="~/vendors/sweet-alert/sweetalert2@11.js"></script>
    <script src="~/scripts/show-notification.js"></script>
    <script src="~/scripts/fetch-api.js"></script>
    <script>
        async function handleLogin(btnLogin) {
            const usernameEl = document.getElementById('username')
            const passwordEl = document.getElementById('password')
            const btnSpinner = document.getElementById('btn-spinner')
            const url = '@RouteConstant.LOGIN_API'
            const postData = {
                username: usernameEl.value,
                password: passwordEl.value
            }

            btnLogin.style.display = 'none'
            btnSpinner.style.display = 'block'
            usernameEl.disabled = true
            passwordEl.disabled = true

            try {
                const response = await postApi(url, postData)
                if (response.Success) {
                    showSuccessLoginNotification(response.Message, () => {window.location.href = '@RouteConstant.DASHBOARD_PAGE';}, 1000)
                    return;
                }

                if (!response.Success) {
                    showErrorNotification(response.Message)
                    btnLogin.style.display = 'block'
                    btnSpinner.style.display = 'none'
                    usernameEl.disabled = false
                    passwordEl.disabled = false
                    return
                }

            } catch (ex) {
                console.log(ex)
            }
        }
    </script>
</body>

</html>